import { ActionPermissions } from '../interfaces'
import { ApolloApis } from './permission.constant'

export const hasActionPermission = (
  permissions: ActionPermissions[] | undefined = [],
  scope: ApolloApis,
) => {
  const has = permissions?.find(
    p => ((p.name as unknown) as ApolloApis) === scope,
  )

  return {
    authorized: Boolean(has?.isAuthorized?.authorized),
    reason: has?.isAuthorized?.reason,
    requiredPlan: has?.isAuthorized?.requiredPlan,
    actionPermission: has,
  }
}
